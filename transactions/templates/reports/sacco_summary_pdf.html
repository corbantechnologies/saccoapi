<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="utf-8">
        <title>SACCO Financial Summary - {{ end_date }}</title>
        <style>
            @page {
                size: A4 portrait;
                margin: 1.5cm;

                @bottom-right {
                    content: "Page " counter(page) " of " counter(pages);
                    font-size: 8pt;
                    color: #64748b;
                }
            }

            body {
                font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                color: #1e293b;
                line-height: 1.5;
                font-size: 10pt;
                margin: 0;
            }

            .header {
                text-align: center;
                border-bottom: 2px solid #1e40af;
                padding-bottom: 15px;
                margin-bottom: 30px;
            }

            .header h1 {
                margin: 0;
                font-size: 22pt;
                color: #1e40af;
                text-transform: uppercase;
            }

            .header p {
                margin: 5px 0 0;
                font-size: 12pt;
                color: #64748b;
            }

            .summary-grid {
                display: table;
                width: 100%;
                margin-bottom: 40px;
                border-spacing: 15px 0;
            }

            .summary-card {
                display: table-cell;
                background: #f8fafc;
                border: 1px solid #e2e8f0;
                border-radius: 8px;
                padding: 15px;
                text-align: center;
            }

            .card-label {
                font-size: 8pt;
                color: #64748b;
                text-transform: uppercase;
                font-weight: 700;
            }

            .card-value {
                font-size: 16pt;
                font-weight: 800;
                color: #0f172a;
                margin-top: 5px;
            }

            .profit-pos {
                color: #059669;
            }

            .profit-neg {
                color: #dc2626;
            }

            .section-title {
                background: #f1f5f9;
                padding: 8px 12px;
                font-size: 11pt;
                font-weight: 700;
                color: #334155;
                border-left: 4px solid #1e40af;
                margin: 25px 0 10px;
            }

            table {
                width: 100%;
                border-collapse: collapse;
                margin-bottom: 20px;
            }

            th,
            td {
                border-bottom: 1px solid #e2e8f0;
                padding: 10px 12px;
                text-align: left;
            }

            th {
                font-size: 8pt;
                text-transform: uppercase;
                color: #64748b;
                font-weight: 600;
            }

            .amount-col {
                text-align: right;
                font-family: 'Courier New', Courier, monospace;
                font-weight: 600;
            }

            .subtotal-row {
                background: #fdfdfd;
                font-weight: 700;
            }

            .footer {
                margin-top: 50px;
                text-align: center;
                font-size: 8pt;
                color: #94a3b8;
                border-top: 1px solid #e2e8f0;
                padding-top: 15px;
            }
        </style>
    </head>

    <body>

        <div class="header">
            <h1>SACCO Financial Summary</h1>
            <p>Consolidated Position as of {{ end_date }}</p>
        </div>

        <div class="summary-grid">
            <div class="summary-card">
                <div class="card-label">Total Assets</div>
                <div class="card-value">Ksh {{ totals.assets|floatformat:2 }}</div>
            </div>
            <div class="summary-card">
                <div class="card-label">Total Liabilities</div>
                <div class="card-value">Ksh {{ totals.liabilities|floatformat:2 }}</div>
            </div>
            <div class="summary-card">
                <div class="card-label">Net Surplus/Deficit</div>
                <div class="card-value {% if net_profit >= 0 %}profit-pos{% else %}profit-neg{% endif %}">
                    Ksh {{ net_profit|floatformat:2 }}
                </div>
            </div>
        </div>

        <!-- Assets -->
        <div class="section-title">I. ASSETS</div>
        <table>
            <thead>
                <tr>
                    <th>Code</th>
                    <th>Account Name</th>
                    <th class="amount-col">Balance (Ksh)</th>
                </tr>
            </thead>
            <tbody>
                {% for acc in assets %}
                <tr>
                    <td>{{ acc.code }}</td>
                    <td>{{ acc.name }}</td>
                    <td class="amount-col">{{ acc.balance|floatformat:2 }}</td>
                </tr>
                {% endfor %}
                <tr class="subtotal-row">
                    <td colspan="2">TOTAL ASSETS</td>
                    <td class="amount-col">{{ totals.assets|floatformat:2 }}</td>
                </tr>
            </tbody>
        </table>

        <!-- Liabilities -->
        <div class="section-title">II. LIABILITIES</div>
        <table>
            <thead>
                <tr>
                    <th>Code</th>
                    <th>Account Name</th>
                    <th class="amount-col">Balance (Ksh)</th>
                </tr>
            </thead>
            <tbody>
                {% for acc in liabilities %}
                <tr>
                    <td>{{ acc.code }}</td>
                    <td>{{ acc.name }}</td>
                    <td class="amount-col">{{ acc.balance|floatformat:2 }}</td>
                </tr>
                {% endfor %}
                <tr class="subtotal-row">
                    <td colspan="2">TOTAL LIABILITIES</td>
                    <td class="amount-col">{{ totals.liabilities|floatformat:2 }}</td>
                </tr>
            </tbody>
        </table>

        <!-- Performance -->
        <div class="section-title">III. INCOME & EXPENDITURE SUMMARY</div>
        <table>
            <tbody>
                <tr>
                    <td>Total Revenue (Interest & Fees)</td>
                    <td class="amount-col">{{ totals.revenue|floatformat:2 }}</td>
                </tr>
                <tr>
                    <td>Total Operating Expenses</td>
                    <td class="amount-col">({{ totals.expenses|floatformat:2 }})</td>
                </tr>
                <tr class="subtotal-row">
                    <td>NET SURPLUS FOR THE PERIOD</td>
                    <td class="amount-col">{{ net_profit|floatformat:2 }}</td>
                </tr>
            </tbody>
        </table>

        <div class="footer">
            <p>&copy; {{ current_year }} Tamarind SACCO. This is an official management report generated on {{
                generated_at }}.</p>
        </div>

    </body>

</html>